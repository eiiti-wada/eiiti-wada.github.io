<html lang="ja">
 
<head>
  <meta charset="utf-8">
  <title>Mondaine Railways Watch</title>
  <style>
canvas {
  border: solid 1px #999;
}
  </style>
</head>
 
<body>
  <a onclick="initialize()">

  <canvas id="mycanvas" width="500" height="500"></canvas> 
  <script>
var canvas = document.getElementById("mycanvas");
var context = canvas.getContext("2d");
function radians(d){return(d*Math.PI/180);}
var alpha=0, beta=0, gamma=0;
//var dt=new Date();
//var hr=dt.getHours(),mn=dt.getMinutes(),sec=dt.getSeconds();
var dt,hr=0,mn=0,sec=0;
var oldmn=mn,oldsec=sec;
var count = sec*100;
var running = false;
var intervalID;
function str(x) {return x<10?" "+x:x;}

function start(){
dt=new Date();
hr=dt.getHours();
mn=dt.getMinutes();
sec=dt.getSeconds();
if(mn!=oldmn){count=0;oldmn=mn;}
//if(sec!=oldsec){count=(sec*100+count)/2;oldsec=sec;}
if(sec!=oldsec){count=sec*100;oldsec=sec;}
alpha=mn*6+180;
beta=hr*30+180+mn/2;
gamma=(count<=5800)?(count*360/5800+180):180;}
			       
function draw() {
context.clearRect(0,0,500,500);
if(running){
dt=new Date();
hr=dt.getHours();
mn=dt.getMinutes();
sec=dt.getSeconds();
if(mn!=oldmn){count=0;oldmn=mn;}
//if(sec!=oldsec){count=(sec*100+count)/2;oldsec=sec;}
if(sec!=oldsec){count=sec*100;oldsec=sec;}
}
alpha=mn*6+180;
beta=hr*30+180+mn/2;
gamma=(count<=5800)?(count*360/5800+180):180;

context.save();
context.translate(250,250);
context.fillStyle="#000000";
context.beginPath();
context.arc(0,0,200,0,Math.PI*2,true);
context.fill();
context.fillStyle="#ffffff";
context.beginPath();
context.arc(0,0,187.5,0,Math.PI*2,false);
context.fill();
//context.closePath();
context.beginPath();
context.fillStyle="#000000";
for(i=0;i<60;i++){context.beginPath();
		  context.fillRect(-1.875,162.5,3.75,12.5);
        	  context.rotate(Math.PI/30);}
for(i=0;i<12;i++){context.beginPath();
		  context.fillRect(-5.625,132.5,11.25,42.5);
        	  context.rotate(Math.PI/6);}
	   context.save();
	   context.rotate(radians(alpha));
	   context.beginPath();
	   context.moveTo(-11.5,-40);
	   context.lineTo(11.5,-40);
	   context.lineTo(6.875,167.5);
	   context.lineTo(-6.875,167.5);
	   context.closePath();
	   context.restore();
	   context.fill();
	   context.save();
	   context.rotate(radians(beta));
	   context.beginPath();
	   context.moveTo(-11.5,-40);
	   context.lineTo(11.5,-40);
	   context.lineTo(8.75,117.5);
	   context.lineTo(-8.75,117.5);
	   context.closePath();
	   context.restore();
	   context.fill();
	   context.save();
	   context.rotate(radians(gamma));
	   context.beginPath();
	   context.fillStyle="#ff0000";
	   context.beginPath();
	   context.arc(0,117.75,13.75,0,Math.PI*2,true);
	   context.closePath();
	   context.fill();
	   context.beginPath();
   	   context.arc(0,0,7.5,0,Math.PI*2,true);
	   context.closePath();
	   context.fill();
	   context.fillRect(-1.25,-57.5,2.5,185);
	   context.restore();
	   context.restore();
	   count=(count+1)%6000;
	   context.font="30px Courier";
    context.textAlign="center";
context.fillStyle="#000000";
	   context.fillText(str(hr)+" "+str(mn)+" "+str(sec),100,50);
	     context.fillText("Railways Watch",350,480);
if (!running){clearInterval(intervalID);}
	   }


	  function doKeyDown(evt){
	  ch=evt.keyCode-48;
	  }
	  
      function getPosition(event)
      {
/*        var x = new Number();
        var y = new Number();
        var canvas = document.getElementById("mycanvas");
        if (event.x != undefined && event.y != undefined)
        {
          x = event.x;
          y = event.y;
        }
        else // Firefox method to get the position
        {
          x = event.clientX + document.body.scrollLeft +
              document.documentElement.scrollLeft;
          y = event.clientY + document.body.scrollTop +
              document.documentElement.scrollTop;
        }

        x -= canvas.offsetLeft;
        y -= canvas.offsetTop;
	   x0=x;y0=y;  
	   intervalID=setInterval(draw,10);*/
        running=!running;
	   if(running){start();intervalID=setInterval(draw,10);}
}

      function initialize()
      { var canvas = document.getElementById("mycanvas");
        canvas.addEventListener("mousedown", getPosition, false);
        window.addEventListener('keydown',doKeyDown,true);
	   }

initialize();
//var intervalID=setInterval(draw,10);
draw();
	   
</script>
</body>
 
</html>

